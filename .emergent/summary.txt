<analysis>original_problem_statement:
The user wants to build a hyperlocal marketplace app called Foodambo for home-based sellers.

**Core Concept:** A platform for sellers to offer homemade food, organic produce, snacks, art, and handmade products to buyers within a 2 km radius.

**PRODUCT REQUIREMENTS:**
-   **Seller Onboarding:** No activation fee. A monthly subscription of ₹299 (due at month-end) or a yearly plan of ₹2000. An upfront activation fee of ₹99 was discussed. A 14-day grace period for failed payments, after which the store is deactivated.
-   **Payments:** Use Razorpay for subscriptions. Direct Buyer-to-Seller UPI payments for orders.
-   **Authentication:** Google Login will be the primary method. (Mobile OTP was requested and then removed).
-   **Core App Flow:** Mandatory location detection on signup. Category-based filtering. Product listings, detailed product pages with store name prominently displayed. Self-listings should be visible but not orderable. Order placement and management.
-   **Seller Features:** Store profile (editable), listing management, order acceptance/rejection. An option to mark a store as Pure Veg. FSSAI certificate upload within 15 days, with an option to request an FSSAI assistance service for ₹999.
-   **Product Details & Categories:** The Create Listing form must be dynamic based on the selected category:
    -   **Categories:** Fresh Food, Pickles, Vegetables & Farm Products, Art, and Party Packages.
    -   **Fields for Fresh Food/Pickles:** Standard fields (spice level, availability, etc.).
    -   **Fields for Veg/Farm:** Name, Photo, Weight, Price, Organic (Y/N).
    -   **Fields for Art:** Name, Photo, Price per Unit, Size/Weight.
-   **Communication:** Order-specific chat between buyers and sellers, which expires 4 hours after the order is delivered.
-   **Reviews & Sharing:** Buyers can rate/review stores and dishes after an order. Reviews should appear on store and product pages. A share button (Link, WhatsApp, Instagram, Facebook) for products and stores.
-   **UI/UX:** Remove Emergent branding from the login page and theme the OAuth callback page. Remove the floating add listing button from the home page. The user and store profiles should be editable.

**User's preferred language**: English

**what currently exists?**
The application is a feature-rich full-stack app (React/FastAPI/MongoDB). The previous agent fixed critical deployment blockers and resolved an ObjectId serialization error in the AI description generator. A significant number of new features were added based on user requests, including a mandatory location setup flow, a dynamic Create Listing form that changes based on category, editable user/store profiles, order-specific chat, and a review/share system. The login process was simplified to Google-only, and UI/UX issues were addressed. The agent began implementing the FSSAI certificate feature and started setting up the backend for Razorpay subscriptions before being paused by the user.

**Last working item**:
-   **Last item agent was working:** Implementing the FSSAI certificate management feature. This includes allowing sellers to upload their certificate or request an assistance service for a fee. The agent created the backend models and API endpoints (, ) and the frontend page ().
-   **Status:** IN PROGRESS
-   **Agent Testing Done:** N
-   **Which testing method agent to use?** Frontend testing agent to test the complete user flow: navigating from the profile, seeing the FSSAI status, uploading a certificate, and requesting assistance.
-   **User Testing Done:** N

**All Pending/In progress Issue list**:
-   **Issue 1:** Own listings are not visible to the seller on the home page. (Priority: P0 - BLOCKER)

Issues Detail:
-   **Issue 1: Own listings not visible**
    -   **Attempted fixes:** The agent identified and removed the  parameter from the  API call in . The agent performed this action twice, indicating a potential issue with the edit saving or a misunderstanding of the root cause. The frontend service was restarted after the last attempt.
    -   **Next debug checklist:**
        1.  Verify the  parameter is truly gone from all API calls fetching products in .
        2.  Check the backend  endpoint logic in  to ensure there isn't another filter removing the seller's own products.
        3.  Use the frontend testing agent to log in as a seller, create a product, and check the home page to definitively reproduce the issue.
    -   **Why fix this issue and what will be achieved with the fix?** Sellers need to see their own listings on the home page to confirm they are live and see how they appear to customers. This is a critical user experience issue.
    -   **Status:** IN PROGRESS
    -   **Is recurring issue?** Y
    -   **Should Test frontend/backend/both after fix?** both
    -   **Blocked on other issue:** None

**In progress Task List**:
-   **Task 1: Complete FSSAI Certificate Feature** (Priority: P0)
    -   **Where to resume**: Connect the frontend components to the backend. In , implement the API calls for file upload to  and for requesting assistance to . Ensure the user's FSSAI status is updated and reflected on the  page.
    -   **What will be achieved with this?** A fully functional FSSAI compliance workflow for sellers.
    -   **Status:** IN PROGRESS
    -   **Should Test frontend/backend/both after fix?** both
    -   **Blocked on something:** None

**Upcoming and Future Tasks**
**Upcoming Tasks:**
-   **P0: Implement Razorpay Subscription System:** The user has provided detailed requirements (₹99 activation, ₹299/month or ₹2000/year, 14-day grace period). The  library is installed, and backend models/endpoints have been created in . The next agent needs to build the frontend payment pages and integrate them with the backend.
-   **P1: Resolve Emergent Auth White Page Issue:** The user is unhappy with the white-label Emergent-hosted OAuth page. The agent must confirm with the user if they want to switch to a direct Google OAuth implementation, which would require the user to provide their own Google Cloud OAuth credentials.
-   **P2: Performance Optimizations:** Address N+1 query patterns and implement pagination on high-traffic endpoints like  as previously recommended by the deployment agent.

**Future Tasks:**
-   Admin Panel for backend management.
-   Delivery partner integration.
-   Wallet/escrow payment system.
-   Seller ads and promotional tools.
-   Facebook Login integration.

**Completed work in this session**
- **Recently completed:**
  - **Deployment & Bug Fixes (DONE):** Fixed deployment build errors and resolved a critical  serialization bug in the AI Description Generator.
  - **Mandatory Location on Signup (DONE):** Implemented a flow that forces new users to set their location via a map () before accessing the app.
  - **Dynamic 'Create Listing' Form (DONE):** Refactored  to conditionally display form fields based on the selected product category (Fresh Food, Art, Party Packages, etc.).
  - **Review and Share Features (DONE):** Implemented a  component for products and stores with options for Link, WhatsApp, Instagram, and Facebook. Added a reviews section to product pages.
  - **Profile & Store Editing (DONE):** Created  and updated  to allow users and sellers to edit their details, including an integrated .
  - **Order-specific Chat (DONE):** Implemented backend endpoints and a frontend  page for buyers and sellers to communicate about a specific order, with a 4-hour expiry post-delivery.
  -**Self-Order Prevention (DONE):** The Place Order button on  is now disabled for sellers viewing their own products.
  - **Authentication & Branding (DONE):** Removed the Mobile OTP login from , making Google Login the sole method. Themed the  loading screen to better match the app's design.
  - **Pure Veg Store Option (DONE):** Added a Pure Veg checkbox to store creation/editing and a badge that displays on the store profile.
  - **UI/UX Fixes (DONE):** Removed the floating 'add' button from  and added the store name to product cards for better visibility.

**Earlier issues found/mentioned but not fixed**
-   **Issue 1: Emergent Auth White Page**
    -   **Debug checklist:** This is not a bug but a feature of Emergent's managed OAuth. The user was presented with two options: 1) Implement direct Google OAuth (requires user credentials), or 2) Keep the current flow. Awaiting user decision.
    -   **Why to solve this issue and what will be achieved with this?** To provide a fully-branded user experience without showing third-party (Emergent) pages during login.
    -   **Should Test frontend/backend/both after fix:** both
    -   **Is recurring issue?** Y

**Known issue recurrence from previous fork**
-   **Issue recurrence in previous fork:** Own dish not yet visible (related to home page product loading).
-   **Recurrence count:** 3+
-   **Status:** IN PROGRESS (The last fix attempt needs verification).

**Code Architecture**


**Key Technical Concepts**
-   **Frontend:** React, React Router, Tailwind CSS, Shadcn/UI, Axios
-   **Backend:** FastAPI (Python), Pydantic, Motor
-   **Database:** MongoDB
-   **Authentication:** Emergent-managed Google OAuth2
-   **Integrations:**  (for AI), Razorpay (planned)

**key DB schema**
-   **users:** 
-   **stores:** 
-   **products:** 
-   **orders:** 
-   **messages:** 

**changes in tech stack**
-   Installed  Python library in the backend.

**All files**
-   : Heavily modified to add models and endpoints for user profile updates, subscriptions (Razorpay), chat, FSSAI management, and order delivery tracking.
-   : Major refactor to support dynamic form fields based on product category.
-   : Modified to add store names to product cards, remove the floating action button, and attempt to fix the self-listing visibility bug.
-   : Modified to remove OTP login and improve branding.
-   : Updated to handle the mandatory location check for new users.
-   : Updated with new routes for , , , , and .
-   **New Files Created:** , , , , , , .

**Areas that need refactoring**:
-   The  file is now over 1000 lines long and contains all models, API routes, and business logic. It should be broken down into a more scalable structure (e.g., , , ).

**key api endpoints**
-   : Updates user profile information, including location.
-   : Fetches chat messages for a specific order.
-   : Sends a new chat message for an order.
-   : Updated to track  time for completed orders.
-   : (Newly added) Handles FSSAI certificate file upload.
-   : (Newly added) Handles requests for FSSAI assistance service.

**Critical Info for New Agent**
-   **Recurring Visibility Bug:** The top priority is to definitively solve the own listings not visible bug. The user has reported this multiple times, and previous fixes have not stuck. Verify the last fix on  and be prepared for a deeper investigation into backend logic or frontend state management.
-   **Paused Razorpay Task:** The user requested a full subscription system with Razorpay but then asked to pause its implementation. The backend setup is partially done. This is the next major feature to tackle after fixing current issues.
-   **FSSAI Feature is In-Progress:** The backend is ready, but the frontend () needs to be connected to the APIs and tested.
-   **Google Auth Decision:** You must follow up with the user about the white page during login. They need to choose between keeping the simple but branded Emergent Auth or switching to a direct Google OAuth implementation (which requires them to provide credentials).

**documents created in this job**
-   : A markdown file created to show the user where the Edit Profile button is located.

**Last 5 User Messages and any pending user messages**
1.  **User Message:** Asks if all users can share dish/store links via one click. (Status: Addressed and Implemented)
2.  **User Message:** Specifies that the share options should be Link, WhatsApp, Instagram, and Facebook. (Status: Addressed and Implemented)
3.  **User Message:** Reports that their own dish is still not visible. (Status: IN PROGRESS)
4.  **User Message:** Reports they cannot see the FSSAI certificate provisioning and requests it, along with a paid assistance service. (Status: IN PROGRESS)
5.  **User Message:** (Previous session) User asks to test the location feature first, pausing the Razorpay implementation. (Status: Completed, now un-paused by subsequent requests)

**Project Health Check:**
-   **Broken:** The product visibility on the home page for the item's own seller is unreliable and a recurring issue.
-   **Mocked:** Phone OTP authentication has been completely removed.
-   **Needs Verification:** The fix for the own listings not visible bug needs immediate user or test agent verification.

**Testing status**
-   **Testing agent used after significant changes:** YES, for location features and verifying fixes.
-   **Troubleshoot agent used after agent stuck in loop:** YES, to diagnose a frontend/backend data mismatch.
-   **Test files created:** None saved permanently.
-   **Known regressions:** The visibility of a seller's own listings on the home page.

**Credentials to test flow:**
-   **Phone Number:** N/A (OTP login removed)
-   **Authentication:** Use the Google Login flow.</analysis>
